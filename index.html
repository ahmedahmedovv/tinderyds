<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no, maximum-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Tinder YDS">
<meta name="theme-color" content="#f4ecd8">
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üî•</text></svg>">
    <title>Tinder YDS - Kelime Kartlarƒ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #f4ecd8;
            min-height: 100vh;
            min-height: -webkit-fill-available;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }

        .header {
            color: #5c4a32;
            padding: 2vh 4vw;
            width: 92%;
            max-width: 420px;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5vh;
        }

        .header h1 {
            font-size: clamp(16px, 5vw, 22px);
            font-weight: 700;
            letter-spacing: -0.5px;
            margin: 0;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 2vw;
        }

        .icon-btn {
            background: transparent;
            border: 1.5px solid #c4b49a;
            color: #8b7355;
            width: clamp(28px, 8vw, 36px);
            height: clamp(28px, 8vw, 36px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            padding: 0;
        }

        .icon-btn:active {
            background: #f0e6d3;
            border-color: #8b7355;
        }

        .icon-btn svg {
            width: clamp(14px, 4vw, 18px);
            height: clamp(14px, 4vw, 18px);
        }

        .streak-badge {
            display: flex;
            align-items: center;
            gap: 4px;
            background: rgba(166, 92, 92, 0.15);
            padding: 0.8vh 2vw;
            border-radius: 20px;
            font-size: clamp(12px, 3.5vw, 14px);
        }

        .streak-badge span {
            font-size: clamp(10px, 3vw, 12px);
        }

        .stats {
            display: flex;
            justify-content: flex-start;
            gap: 6vw;
            font-size: clamp(11px, 3vw, 13px);
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 0.3vh;
        }

        .stat-label {
            font-size: clamp(8px, 2.5vw, 10px);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.6;
            font-weight: 500;
        }

        .stat-item strong {
            font-size: clamp(14px, 4vw, 18px);
            font-weight: 700;
        }

        .card-container {
            position: relative;
            width: 92%;
            max-width: 420px;
            height: calc(65vh - 100px);
            min-height: 320px;
            max-height: 480px;
            margin: 1.5vh auto;
            perspective: 1000px;
            flex: 1;
        }

        .card {
            position: absolute;
            width: 100%;
            height: 100%;
            background: #fdf6e3;
            border-radius: 2vw;
            max-radius: 16px;
            box-shadow: 0 4px 20px rgba(92, 74, 50, 0.15);
            display: flex;
            flex-direction: column;
            padding: 3vh 4vw;
            transition: transform 0.25s ease, opacity 0.25s ease;
            cursor: grab;
            user-select: none;
            touch-action: none;
            overflow: hidden;
            border: 1px solid #e8dcc8;
        }

        .card:active {
            cursor: grabbing;
        }

        .card.swiping-left {
            transform: translateX(-150%) rotate(-30deg);
            opacity: 0;
        }

        .card.swiping-right {
            transform: translateX(150%) rotate(30deg);
            opacity: 0;
        }

        .card-badge {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            padding: 2vh 5vw;
            border: 3px solid;
            border-radius: 2vw;
            max-radius: 12px;
            font-size: clamp(20px, 6vw, 32px);
            font-weight: bold;
            text-transform: uppercase;
            opacity: 0;
            transition: opacity 0.15s, transform 0.15s;
            z-index: 10;
            background: rgba(253, 246, 227, 0.98);
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .card-badge.know {
            color: #5a7c5a;
            border-color: #5a7c5a;
            --rotation: 8deg;
        }

        .card-badge.dont-know {
            color: #a65c5c;
            border-color: #a65c5c;
            --rotation: -8deg;
        }

        .card-badge.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1) rotate(var(--rotation, 0deg));
        }

        .word {
            font-size: clamp(20px, 6vw, 28px);
            font-weight: bold;
            color: #3d3229;
            text-align: center;
            margin-bottom: 1vh;
            margin-top: 0.5vh;
            flex-shrink: 0;
            font-family: Georgia, 'Times New Roman', serif;
        }

        .divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, #c4b49a, transparent);
            margin: 1vh 0 1.5vh 0;
            flex-shrink: 0;
        }

        .section-title {
            font-size: clamp(9px, 2.5vw, 11px);
            text-transform: uppercase;
            color: #8b7355;
            letter-spacing: 1px;
            margin-bottom: 0.8vh;
            flex-shrink: 0;
            font-weight: 600;
        }

        .definition {
            font-size: clamp(13px, 4vw, 16px);
            color: #4a3f35;
            line-height: 1.5;
            text-align: center;
            flex-shrink: 0;
            font-family: Georgia, 'Times New Roman', serif;
        }

        .example {
            font-size: clamp(13px, 4vw, 15px);
            color: #5c4a32;
            font-style: italic;
            line-height: 1.5;
            text-align: center;
            padding: 2vh 3vw;
            background: #f5efe3;
            border-radius: 2vw;
            max-radius: 12px;
            border: none;
            flex-shrink: 0;
            font-family: Georgia, 'Times New Roman', serif;
        }

        .example .highlight-word {
            font-weight: 700;
            color: #3d3229;
            font-style: normal;
            background: linear-gradient(120deg, #e8d4a8 0%, #e8d4a8 100%);
            background-repeat: no-repeat;
            background-size: 100% 40%;
            background-position: 0 88%;
            padding: 0 4px;
            border-radius: 2px;
        }

        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            color: #8b7355;
        }

        .spinner {
            width: clamp(28px, 8vw, 40px);
            height: clamp(28px, 8vw, 40px);
            border: 3px solid #e8dcc8;
            border-top: 3px solid #8b7355;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1vh;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .controls {
            display: flex;
            gap: 10vw;
            margin-top: 2vh;
            margin-bottom: calc(2vh + env(safe-area-inset-bottom));
        }

        .btn {
            width: clamp(48px, 14vw, 64px);
            height: clamp(48px, 14vw, 64px);
            border-radius: 50%;
            border: 2px solid;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.15s, box-shadow 0.15s, background 0.15s;
            box-shadow: 0 2px 10px rgba(92, 74, 50, 0.1);
        }

        .btn svg {
            width: clamp(20px, 5vw, 26px);
            height: clamp(20px, 5vw, 26px);
            stroke-width: 2.5;
        }

        .btn:hover {
            transform: scale(1.1);
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn-dont-know {
            background: transparent;
            border-color: #c4a8a8;
            color: #a65c5c;
        }

        .btn-dont-know:active {
            background: #a65c5c;
            border-color: #a65c5c;
        }

        .btn-dont-know:active svg {
            stroke: #fdf6e3;
        }

        .btn-know {
            background: transparent;
            border-color: #a8c4a8;
            color: #5a7c5a;
        }

        .btn-know:active {
            background: #5a7c5a;
            border-color: #5a7c5a;
        }

        .btn-know:active svg {
            stroke: #fdf6e3;
        }

        .empty-state {
            text-align: center;
            color: #5c4a32;
            padding: 4vh 5vw;
        }

        .empty-state h2 {
            font-size: clamp(18px, 5vw, 24px);
            margin-bottom: 2vh;
        }

        .empty-state p {
            font-size: clamp(12px, 3.5vw, 14px);
            opacity: 0.8;
            margin-bottom: 3vh;
        }

        .btn-primary {
            background: #fdf6e3;
            color: #5c4a32;
            border: 1px solid #c4b49a;
            padding: 1.5vh 6vw;
            border-radius: 25px;
            font-size: clamp(13px, 3.5vw, 15px);
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .btn-primary:active {
            transform: scale(0.95);
        }

        .progress-bar {
            width: 92%;
            max-width: 420px;
            height: 0.6vh;
            min-height: 3px;
            max-height: 6px;
            background: rgba(92, 74, 50, 0.2);
            border-radius: 2px;
            margin: 1vh auto;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #8b7355;
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        .level-indicator {
            position: absolute;
            top: 1.5vh;
            right: 3vw;
            font-size: clamp(9px, 2.5vw, 11px);
            color: #8b7355;
            background: #f0e6d3;
            padding: 0.4vh 1.5vw;
            border-radius: 8px;
        }



        .swipe-hint span {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(92, 74, 50, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            padding: 4vw;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: #fdf6e3;
            border-radius: 3vw;
            max-width: 420px;
            width: 100%;
            max-height: 85vh;
            display: flex;
            flex-direction: column;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            transform: scale(0.9);
            transition: transform 0.3s;
        }

        .modal-overlay.show .modal-content {
            transform: scale(1);
        }

        .modal-close {
            position: absolute;
            top: 2vh;
            right: 3vw;
            background: transparent;
            border: none;
            color: #8b7355;
            cursor: pointer;
            padding: 1vh;
            z-index: 10;
        }

        .modal-close svg {
            width: 24px;
            height: 24px;
        }

        .modal-header {
            padding: 3vh 4vw 2vh;
            text-align: center;
            border-bottom: 1px solid #e8dcc8;
        }

        .modal-header h2 {
            color: #5c4a32;
            font-size: clamp(18px, 5vw, 22px);
            margin: 0;
        }

        .modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 2vh 4vw;
        }

        .info-section {
            margin-bottom: 3vh;
        }

        .info-section h3 {
            color: #5c4a32;
            font-size: clamp(14px, 4vw, 16px);
            margin-bottom: 1.5vh;
            font-weight: 600;
        }

        .info-text {
            color: #6b5a48;
            font-size: clamp(12px, 3.5vw, 14px);
            line-height: 1.6;
            margin-bottom: 2vh;
        }

        .swipe-demo {
            display: flex;
            flex-direction: column;
            gap: 1.5vh;
        }

        .swipe-item {
            display: flex;
            align-items: center;
            gap: 3vw;
            background: #f5efe3;
            padding: 1.5vh 3vw;
            border-radius: 2vw;
        }

        .swipe-icon {
            font-size: 20px;
            font-weight: bold;
            color: #8b7355;
            width: 30px;
            text-align: center;
        }

        .swipe-item strong {
            color: #5c4a32;
            font-size: clamp(13px, 3.5vw, 14px);
            display: block;
            margin-bottom: 0.3vh;
        }

        .swipe-item p {
            color: #8b7355;
            font-size: clamp(11px, 3vw, 12px);
            margin: 0;
        }

        .levels-table {
            background: #f5efe3;
            border-radius: 2vw;
            overflow: hidden;
        }

        .level-row {
            display: grid;
            grid-template-columns: 1fr 1.5fr 1fr;
            padding: 1.2vh 3vw;
            font-size: clamp(11px, 3vw, 12px);
            color: #6b5a48;
            border-bottom: 1px solid #e8dcc8;
        }

        .level-row:last-child {
            border-bottom: none;
        }

        .level-header {
            background: #e8dcc8;
            font-weight: 600;
            color: #5c4a32;
        }

        .level-row.highlight {
            background: #e8f5e9;
            color: #2e7d32;
            font-weight: 600;
        }

        .tips-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .tips-list li {
            padding: 1vh 0 1vh 3vw;
            color: #6b5a48;
            font-size: clamp(12px, 3.5vw, 13px);
            line-height: 1.5;
            position: relative;
        }

        .tips-list li::before {
            content: "‚Ä¢";
            color: #8b7355;
            position: absolute;
            left: 0.5vw;
        }

        .stats-explained {
            display: flex;
            flex-direction: column;
            gap: 1.5vh;
        }

        .stat-explained {
            background: #f5efe3;
            padding: 1.5vh 3vw;
            border-radius: 2vw;
        }

        .stat-explained strong {
            color: #5c4a32;
            font-size: clamp(13px, 3.5vw, 14px);
            display: block;
            margin-bottom: 0.3vh;
        }

        .stat-explained p {
            color: #8b7355;
            font-size: clamp(11px, 3vw, 12px);
            margin: 0;
        }

        .modal-footer {
            padding: 2vh 4vw 3vh;
            text-align: center;
            border-top: 1px solid #e8dcc8;
        }

        /* Word List Modal Specific Styles */
        .word-list-modal .modal-header {
            padding: 2vh 4vw 1vh;
        }

        .word-list-tabs {
            display: flex;
            gap: 1vw;
            margin-top: 1.5vh;
        }

        .tab-btn {
            flex: 1;
            padding: 1vh 2vw;
            border: 1px solid #c4b49a;
            background: transparent;
            color: #8b7355;
            border-radius: 2vw;
            font-size: clamp(11px, 3vw, 13px);
            cursor: pointer;
            transition: all 0.2s;
        }

        .tab-btn.active {
            background: #8b7355;
            color: #fdf6e3;
            border-color: #8b7355;
        }

        .word-list-search {
            padding: 1vh 4vw;
            border-bottom: 1px solid #e8dcc8;
        }

        .word-list-search input {
            width: 100%;
            padding: 1.2vh 3vw;
            border: 1px solid #c4b49a;
            border-radius: 2vw;
            background: #f5efe3;
            color: #5c4a32;
            font-size: clamp(13px, 3.5vw, 14px);
            outline: none;
        }

        .word-list-search input::placeholder {
            color: #a09078;
        }

        .word-list-body {
            padding: 1vh 0 0 0 !important;
        }

        .word-list-summary {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2vw;
            padding: 1.5vh 4vw;
            background: #f5efe3;
            border-bottom: 1px solid #e8dcc8;
        }

        .summary-item {
            text-align: center;
        }

        .summary-number {
            display: block;
            font-size: clamp(16px, 4.5vw, 20px);
            font-weight: 700;
            color: #5c4a32;
        }

        .summary-label {
            font-size: clamp(9px, 2.5vw, 11px);
            color: #8b7355;
            text-transform: uppercase;
        }

        .word-list-container {
            padding: 1vh 4vw 2vh;
            overflow-y: auto;
            max-height: calc(85vh - 200px);
        }

        .word-list-container::-webkit-scrollbar {
            width: 4px;
        }

        .word-list-container::-webkit-scrollbar-thumb {
            background: #c4b49a;
            border-radius: 2px;
        }

        .word-group {
            margin-bottom: 2vh;
        }

        .word-group-title {
            font-size: clamp(11px, 3vw, 12px);
            color: #8b7355;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 1vh;
            padding-left: 1vw;
        }

        .word-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5vh 3vw;
            background: #fdf6e3;
            border: 1px solid #e8dcc8;
            border-radius: 2vw;
            margin-bottom: 1vh;
            transition: all 0.2s;
        }

        .word-item:active {
            background: #f5efe3;
        }

        .word-info {
            flex: 1;
        }

        .word-name {
            font-size: clamp(14px, 4vw, 16px);
            font-weight: 600;
            color: #5c4a32;
            margin-bottom: 0.3vh;
        }

        .word-status {
            display: flex;
            align-items: center;
            gap: 2vw;
        }

        .level-badge {
            font-size: clamp(10px, 2.8vw, 11px);
            padding: 0.3vh 1.5vw;
            border-radius: 10px;
            background: #e8dcc8;
            color: #8b7355;
        }

        .level-badge.learned {
            background: #c8e6c9;
            color: #2e7d32;
        }

        .level-badge.new {
            background: #f5f5f5;
            color: #9e9e9e;
        }

        .next-review {
            font-size: clamp(9px, 2.5vw, 10px);
            color: #a09078;
        }

        .word-progress {
            width: clamp(40px, 12vw, 60px);
            height: 4px;
            background: #e8dcc8;
            border-radius: 2px;
            overflow: hidden;
        }

        .word-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #8b7355, #a08060);
            border-radius: 2px;
            transition: width 0.3s;
        }

        .word-progress-bar.learned {
            background: linear-gradient(90deg, #4caf50, #66bb6a);
        }

        .empty-list {
            text-align: center;
            padding: 4vh 2vw;
            color: #8b7355;
        }

        .empty-list-icon {
            font-size: 32px;
            margin-bottom: 1vh;
        }

        .empty-list-text {
            font-size: clamp(12px, 3.5vw, 14px);
        }

        /* Responsive for very small screens */
        @media (max-height: 700px) {
            .header {
                padding: 1.5vh 4vw;
            }

            .header-top {
                margin-bottom: 1vh;
            }

            .card-container {
                min-height: 280px;
            }

            .word {
                margin-bottom: 0.8vh;
            }

            .example {
                padding: 1.5vh 3vw;
            }

            .modal-content {
                max-height: 90vh;
            }
        }

        /* Large screens */
        @media (min-width: 768px) {
            .card-container {
                max-width: 480px;
                max-height: 600px;
            }

            .header {
                max-width: 480px;
            }

            .modal-content {
                border-radius: 16px;
            }

            .swipe-item, .level-row, .stat-explained, .levels-table {
                border-radius: 12px;
            }

            .word-list-modal .modal-content {
                max-width: 500px;
            }

            .word-item, .tab-btn, .word-list-search input {
                border-radius: 12px;
            }
        }

        /* iPhone 13 Mini Optimizations (375x812) */
        @media (max-width: 380px) and (max-height: 815px) {
            .header {
                padding: 10px 16px;
            }

            .header-top {
                margin-bottom: 10px;
            }
            
            .header h1 {
                font-size: 18px;
            }

            .streak-badge {
                padding: 3px 8px;
                font-size: 12px;
            }

            .streak-badge span {
                font-size: 10px;
            }
            
            .stats {
                gap: 20px;
                font-size: 12px;
            }

            .stat-label {
                font-size: 9px;
            }

            .stat-item strong {
                font-size: 16px;
            }
            
            .card-container {
                height: 360px;
                margin: 4px auto;
            }
            
            .card {
                padding: 14px;
                border-radius: 14px;
            }
            
            .word {
                font-size: 22px;
                margin-top: 0;
                margin-bottom: 4px;
            }
            
            .divider {
                margin: 3px 0 6px 0;
            }
            
            .section-title {
                font-size: 9px;
                margin-bottom: 2px;
            }
            
            .example {
                font-size: 14px;
                padding: 10px 12px;
                line-height: 1.55;
                text-align: center;
            }
            
            .definition {
                font-size: 14px;
                line-height: 1.55;
                text-align: center;
            }
            
            .content-scroll {
                gap: 8px;
            }
            
            .swipe-hint {
                font-size: 10px;
                padding-top: 6px;
            }
            
            .controls {
                gap: 40px;
                margin-top: 6px;
                margin-bottom: calc(8px + env(safe-area-inset-bottom));
            }
            
            .btn {
                width: 52px;
                height: 52px;
            }

            .btn svg {
                width: 22px;
                height: 22px;
            }
            
            .card-badge {
                font-size: 26px;
                padding: 10px 22px;
                border-width: 3px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-top">
            <h1>Tinder YDS</h1>
            <div class="header-actions">
                <button class="icon-btn" onclick="showWordListModal()" title="Word List">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                        <path d="M9 6h11M9 12h11M9 18h11M5 6h.01M5 12h.01M5 18h.01"/>
                    </svg>
                </button>
                <button class="icon-btn" onclick="showInfoModal()" title="How to use">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 16v-4M12 8h.01"/>
                    </svg>
                </button>
                <div class="streak-badge">
                    <span>üî•</span>
                    <strong id="streakCount">0</strong>
                </div>
            </div>
        </div>
        <div class="stats">
            <div class="stat-item">
                <span class="stat-label">Review</span>
                <strong id="toReviewCount">0</strong>
            </div>
            <div class="stat-item">
                <span class="stat-label">Learned</span>
                <strong id="learnedCount">0</strong>
            </div>
        </div>
    </div>

    <!-- Word List Modal -->
    <div class="modal-overlay" id="wordListModal" onclick="closeWordListModal(event)">
        <div class="modal-content word-list-modal" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeWordListModal()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                    <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
            </button>
            
            <div class="modal-header">
                <h2>üìñ Word List</h2>
                <div class="word-list-tabs">
                    <button class="tab-btn active" onclick="filterWords('all')" data-filter="all">All</button>
                    <button class="tab-btn" onclick="filterWords('learning')" data-filter="learning">Learning</button>
                    <button class="tab-btn" onclick="filterWords('learned')" data-filter="learned">Learned</button>
                </div>
            </div>
            
            <div class="word-list-search">
                <input type="text" id="wordSearch" placeholder="Search words..." oninput="searchWords()">
            </div>
            
            <div class="modal-body word-list-body">
                <div class="word-list-summary">
                    <div class="summary-item">
                        <span class="summary-number" id="totalWordsCount">0</span>
                        <span class="summary-label">Total</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-number" id="learningWordsCount">0</span>
                        <span class="summary-label">Learning</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-number" id="learnedWordsCount">0</span>
                        <span class="summary-label">Learned</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-number" id="progressPercent">0%</span>
                        <span class="summary-label">Progress</span>
                    </div>
                </div>
                
                <div class="word-list-container" id="wordListContainer">
                    <!-- Words will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Info Modal -->
    <div class="modal-overlay" id="infoModal" onclick="closeInfoModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeInfoModal()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                    <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
            </button>
            
            <div class="modal-header">
                <h2>üìö How to Use</h2>
            </div>
            
            <div class="modal-body">
                <section class="info-section">
                    <h3>üéØ Swipe to Review</h3>
                    <div class="swipe-demo">
                        <div class="swipe-item">
                            <span class="swipe-icon">‚Üê</span>
                            <div>
                                <strong>Don't Know</strong>
                                <p>Swipe left or tap X. Word will appear again soon.</p>
                            </div>
                        </div>
                        <div class="swipe-item">
                            <span class="swipe-icon">‚Üí</span>
                            <div>
                                <strong>Know It</strong>
                                <p>Swipe right or tap ‚úì. Word moves to next level.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="info-section">
                    <h3>üß† Spaced Repetition</h3>
                    <p class="info-text">This app uses a scientifically proven method to maximize long-term memory retention. Words you know appear less frequently; words you struggle with appear more often.</p>
                    
                    <div class="levels-table">
                        <div class="level-row level-header">
                            <span>Level</span>
                            <span>Next Review</span>
                            <span>Status</span>
                        </div>
                        <div class="level-row"><span>0</span><span>Now</span><span>New</span></div>
                        <div class="level-row"><span>1</span><span>1 day</span><span>Learning</span></div>
                        <div class="level-row"><span>2</span><span>3 days</span><span>Learning</span></div>
                        <div class="level-row"><span>3</span><span>7 days</span><span>Learning</span></div>
                        <div class="level-row highlight"><span>4+</span><span>14+ days</span><span>‚úì Learned</span></div>
                    </div>
                </section>

                <section class="info-section">
                    <h3>üí° Tips for Success</h3>
                    <ul class="tips-list">
                        <li>Review daily to maintain your streak üî•</li>
                        <li>Be honest - mark "Don't Know" if you're unsure</li>
                        <li>Read the example sentence aloud</li>
                        <li>Try to use the word in your own sentence</li>
                        <li>Level 4+ words count as "Learned"</li>
                    </ul>
                </section>

                <section class="info-section">
                    <h3>üìä Stats Explained</h3>
                    <div class="stats-explained">
                        <div class="stat-explained">
                            <strong>Review</strong>
                            <p>Words due for review today</p>
                        </div>
                        <div class="stat-explained">
                            <strong>Learned</strong>
                            <p>Words at Level 4 or higher</p>
                        </div>
                        <div class="stat-explained">
                            <strong>üî• Streak</strong>
                            <p>Consecutive days you've reviewed</p>
                        </div>
                    </div>
                </section>
            </div>
            
            <div class="modal-footer">
                <button class="btn-primary" onclick="closeInfoModal()">Got it!</button>
            </div>
        </div>
    </div>

    <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
    </div>

    <div class="card-container" id="cardContainer">
        <!-- Cards will be injected here -->
    </div>

    <div class="controls" id="controls">
        <button class="btn btn-dont-know" onclick="handleDontKnow()" title="Don't Know (Left Arrow)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                <path d="M18 6L6 18M6 6l12 12"/>
            </svg>
        </button>
        <button class="btn btn-know" onclick="handleKnow()" title="Know It (Right Arrow)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20 6L9 17l-5-5"/>
            </svg>
        </button>
    </div>

    <script>
        // Word list from mywords.js
        const MYWORDS = [
            "Abide by", "Abnormal", "Abolish", "Abort", "Abrupt", "Absurd", "Abundant", "Academic",
            "Accelerate", "Accessible", "Accidental", "Accommodate", "Accomplish", "Account for",
            "Accountable", "Accumulate", "Accurate", "Accurately", "Accusation", "Accuse of",
            "Accustomed", "Achieve", "Acknowledge", "Acquainted with", "Acquire", "Act out",
            "Activate", "Adapt", "Adapt to", "Addicted to", "Adequate", "Adjust", "Admire",
            "Adopt", "Advance", "Advocate", "Affect", "Afford", "Affordable", "Afterwards",
            "Agreeable", "Alarming", "Alert", "Along with", "Alter", "Ambitious", "Amusing",
            "Ancient", "Annoyed", "Anticipate", "Antique", "Anxious", "Apparent", "Apparently",
            "Appealing", "Applaud", "Appropriately", "Approve of", "Approximate", "Approximately",
            "Arise", "Artificial", "Ascending", "Aspect", "Assault", "Assemble", "Assess",
            "Assign", "Assist", "Associate", "Assorted", "Assume", "Assure", "Astonish",
            "Astonished", "Astonishing", "At all costs", "Attach importance to", "Attached",
            "Attain", "Attempt", "Attentive", "Attribute", "Authentic", "Authorize", "Available",
            "Awareness", "Bankrupt", "Barely", "Be characterized by", "Be composed of",
            "Be engaged in", "Be found in", "Be made up of", "Be marked by", "Be seen in",
            "Be traced back to", "Become extinct", "Beneficial", "Betray", "Biased", "Bitter",
            "Bizarre", "Blame for", "Blend", "Blooming", "Blossom", "Blow up", "Blurred",
            "Bold", "Boldly", "Bond", "Boost", "Bothered", "Bottomless", "Bravely",
            "Break away from", "Break off", "Break out", "Break out of", "Breath-taking",
            "Brilliant", "Bring down", "Bring forward", "Bring in", "Bring out", "Bring over",
            "Bring up", "Bring upon", "Broaden", "Brutal", "Build in", "Bump into",
            "By definition", "By means of", "By nature", "By no means", "Candid", "Capable",
            "Casually", "Catch on", "Catch up with", "Cautious", "Centrally", "Certainty",
            "Certify", "Challenging", "Characterize", "Charge with", "Charming", "Cite",
            "Civilized", "Clashing", "Clarify", "Classify", "Collective", "Colonize",
            "Combine", "Come into being", "Come up with", "Command", "Commercial", "Commit",
            "Commonplace", "Comparable", "Compared with", "Compatible", "Competent", "Complex",
            "Complicated", "Composed of", "Concentrate", "Concerned", "Conclude", "Conclusive",
            "Conclusively", "Concrete", "Conduct", "Confident", "Confidently", "Confirm",
            "Conflict", "Confront", "Confronting", "Confuse", "Confusing", "Conscious",
            "Consciously", "Conserve", "Consider", "Considerably", "Considerate", "Considerately",
            "Consistent", "Consist of", "Construct", "Consume", "Contain", "Contemporary",
            "Continuous", "Continuously", "Contradicting", "Contradictory", "Contrary to",
            "Contribute", "Controversial", "Conventional", "Convert into", "Convey",
            "Convincing", "Convincingly", "Cooperate", "Cooperative", "Cope with", "Corrupt",
            "Countless", "Courageously", "Cowardly", "Cozy", "Creative", "Credible", "Credit",
            "Deceitful", "Deceitfully", "Deceive", "Decent", "Decently", "Deceptive",
            "Deceptively", "Decisive", "Decisively", "Decline", "Defeat", "Defectively",
            "Defence", "Defenceless", "Defiant", "Defiantly", "Deficient", "Deficiently",
            "Define", "Definite", "Degenerate", "Delude", "Delusively", "Demanding",
            "Demolish", "Demonstrate", "Densely", "Deny", "Depart", "Depend on", "Dependable",
            "Dependent on", "Depict", "Deprived of", "Derive", "Descend", "Desert", "Deserve",
            "Design", "Desire", "Desperately", "Destructive", "Detach", "Detect", "Determined",
            "Determine", "Devastate", "Devastating", "Devote", "Devoted", "Diagnose", "Dictate",
            "Differ", "Diminish", "Dire", "Discard", "Discontinued", "Discontinue", "Discover",
            "Disguise", "Dishonest", "Disintegrate", "Dismiss", "Dismantle", "Disobedient",
            "Disobediently", "Disorder", "Disparate", "Dispel", "Displace", "Display",
            "Displeased", "Disposable", "Dispose of", "Disputably", "Dispute", "Disputed",
            "Disregard", "Disrupt", "Disseminate", "Distant", "Distinct", "Distinctive",
            "Distinguish", "Distinguished", "Distorted", "Distract", "Distressed", "Distribute",
            "Distrustfully", "Diverge", "Divergent", "Diverse", "Divine", "Divorce", "Domestic",
            "Dominate", "Dominant", "Doubtful", "Doubtfully", "Drain", "Dramatic", "Dramatically",
            "Drastic", "Drastically", "Draw out", "Draw up", "Dreadful", "Dubious", "Dubiously",
            "Duplicate", "Durable", "Eager", "Economical", "Efficient", "Elaborate",
            "Elaborately", "Elastic", "Elegant", "Eligible", "Eliminate", "Embarrassing",
            "Embrace", "Emerge", "Emphasize", "Employ", "Empower", "Enable", "Encounter",
            "Encourage", "Endanger", "Enforce", "Enforced", "Engulf", "Enhance", "Enlarge",
            "Enlighten", "Enlist", "Enormous", "Enormously", "Enraged", "Ensuing", "Ensure",
            "Enthusiastic", "Entitled", "Equally", "Equipped", "Equivalent", "Equivalently",
            "Escalate", "Essential", "Essentially", "Establish", "Established", "Estimate",
            "Estrange", "Evacuate", "Evaluate", "Evenly", "Eventually", "Evident", "Evidently",
            "Evolve", "Evolve into", "Exceed", "Exceeding", "Exceedingly", "Excel",
            "Exceptional", "Exceptionally", "Exchange ideas", "Exclude", "Execute", "Exhaust",
            "Exhibit", "Existent", "Exotic", "Expand", "Expanding", "Expel", "Explicit",
            "Explore", "Expose", "Extended", "Extensive", "Extensively", "Extinguisher",
            "Extraordinary", "Extravagant", "Extreme", "Extremely", "Fabricated", "Fabulous",
            "Facilitate", "Factual", "Fade away", "Falsify", "Fanatical", "Far-reaching",
            "Fascinate", "Fascinating", "Faulty", "Favouring", "Fearsome", "Feature", "Fertile",
            "Feverish", "Firmly", "Flexible", "Flee", "Flourish", "Flourishing", "Follow up",
            "For a fraction of", "For the sake of", "Forecast", "Foresight", "Former",
            "Formerly", "Fortify", "Foster", "Found", "Fragile", "Fragment", "Frank",
            "Frustrated", "Fruitful", "Fulfill", "Fulfil", "Function", "Fundamental",
            "Fundamentally", "Gainful", "Gaze at", "Generate", "Genuine", "Gigantic",
            "Glance at", "Gleaming", "Glimpse", "Glimpse at", "Globally", "Gloomy", "Govern",
            "Gradual", "Grant", "Grasp", "Grave", "Guarantee", "Guiltless", "Habitual",
            "Hail", "Harmful", "Harsh", "Harshly", "Hastily", "Hazardous", "Heavenly",
            "Hesitantly", "Highborn", "Highlight", "Hindering", "Hint", "Horrifying",
            "Hostile", "Humble", "Humiliating", "Humorous", "Hurriedly", "Identical", "Idle",
            "Illuminate", "Illustrate", "Imaginative", "Imitation", "Immense", "Immortal",
            "Impaired", "Imperial", "Imperfectly", "Impressive", "Imprisoned", "In a nutshell",
            "In abundance", "In accord with", "In accordance with", "In advance",
            "In alignment with", "In an attempt to", "In an effort to", "In anticipation of",
            "In charge of", "In collaboration with", "In combination with", "In compliance with",
            "In conjunction with", "In contact with", "In detail", "In excess of", "In favor of",
            "In good order", "In isolation", "In line with", "In many respects", "In moderation",
            "In place of", "In possession of", "In preparation for", "In pursuit of",
            "In reality", "In recognition of", "In relation to", "In response to", "In search of",
            "In terms of", "In the context of", "In the course of", "In the face of",
            "In the name of", "In the wake of", "In touch with", "Inaccessible", "Inadequately",
            "Inadequate", "Incidental", "Incidentally", "Inclusive", "Inclusively",
            "Inconsiderate", "Inconsistently", "Incredible", "Incredibly", "Indecisive",
            "Indecisively", "Independently", "Indicate", "Indifferent", "Indifferently",
            "Individual", "Inexpensive", "Infinite", "Influential", "Informally", "Inhuman",
            "Initially", "Inject", "Innocent", "Innovative", "Insane", "Insignificant",
            "Insincere", "Insistent", "Instantly", "Institute", "Instruct", "Insufficiently",
            "Insult", "Intended", "Intensely", "Intentional", "Intentionally", "Interfere",
            "Interpret", "Invaluable", "Invade", "Inventive", "Investigate", "Involve",
            "Irrelevant", "Irreplaceable", "Irritated", "Isolate", "Isolated", "Joint",
            "Joyous", "Justifiable", "Justify", "Keen", "Label", "Largely", "Lasting",
            "Launch", "Leisurely", "Lengthy", "Liable", "Limited", "Locate", "Logical",
            "Logically", "Long for", "Long-term", "Lucid", "Magnificent", "Magnify",
            "Maintain", "Malevolent", "Manipulate", "Manufacture", "Marketable", "Mask",
            "Massive", "Matchless", "Mature", "Mental", "Merciless", "Merge", "Mighty",
            "Minor", "Mischievous", "Misleading", "Mismatched", "Moderate", "Modest",
            "Modify", "Monetary", "Mortal", "Motivate", "Mount", "Mounting", "Mutual",
            "Naive", "Needy", "Neglect", "Neglectfully", "Negligently", "Negotiate",
            "Neutral", "Noble", "Non-stop", "Notable", "Noteworthy", "Notify", "Null",
            "Object to", "Objective", "Objectively", "Obscurely", "Observe", "Obtain",
            "Occupy", "Occur", "Omit", "On behalf of", "On the basis of", "On the grounds of",
            "Oppressively", "Optimistic", "Originate", "Outline", "Outstanding", "Overcome",
            "Overlap", "Overlook", "Overpower", "Overrun", "Particularly", "Participate in",
            "Pave the way for", "Peculiarly", "Perceive", "Perplexed", "Perplexing", "Persist",
            "Persistent", "Persuade", "Persuasively", "Pessimistic", "Phase out", "Picturesque",
            "Pin down", "Plausible", "Plentiful", "Plot", "Plunge", "Ponder", "Portable",
            "Portray", "Pose", "Postpone", "Precise", "Precisely", "Predict", "Preserve",
            "Pretend", "Prevailing", "Primary", "Prior to", "Proficient", "Profitable",
            "Progress", "Prohibit", "Project", "Prolonged", "Promote", "Prompt", "Promptly",
            "Prone", "Proper", "Properly", "Propose", "Prosperous", "Provisionally",
            "Proximate", "Psychological", "Publish", "Punctual", "Purely", "Pursue", "Puzzled",
            "Questionable", "Questionably", "Quote", "Raid", "Rational", "Rationalize",
            "Rebellious", "Recollect", "Recruit", "Redundant", "Refer to", "Refine",
            "Reflect", "Reform", "Regard", "Regardless of", "Regulate", "Rehearse",
            "Reinforce", "Reject", "Relate", "Related", "Release", "Relevant", "Reliable",
            "Reluctantly", "Rely on", "Remark", "Remarkable", "Remote", "Renew", "Renovate",
            "Renowned", "Repel", "Resemble", "Reside", "Resist", "Resolve", "Respectively",
            "Rest on", "Restrain", "Restlessly", "Retain", "Retire", "Retreat", "Reverse",
            "Revise", "Revolutionize", "Rigid", "Roam", "Robust", "Root out", "Ruin",
            "Ruined", "Rule out", "Rural", "Sack", "Satirical", "Scan", "Scarcely",
            "Scatter", "Securely", "Seductive", "Seek", "Seemingly", "Seize", "Sensibly",
            "Sensitive", "Sentenced", "Sequential", "Sequentially", "Severe", "Severely",
            "Shallow", "Shameful", "Shatter", "Shed light on", "Shield", "Shift", "Shoulder",
            "Showy", "Shrinking", "Significant", "Significantly", "Signify", "Simulate",
            "Sincerely", "Single-mindedly", "Skilled", "Slight", "Slightly", "Sluggish",
            "Sluggishly", "Soaring", "Solely", "Sophisticated", "Spark", "Specifically",
            "Specify", "Spectacular", "Speculate", "Stable", "Standardize", "Stark",
            "Startled", "Steep", "Stem from", "Stern", "Stimulate", "Strenuous", "Strengthen",
            "Stress", "Striking", "Struggle", "Stubbornly", "Stunning", "Subject to",
            "Submerge", "Submit", "Subsequent", "Subsequently", "Substantial", "Substantially",
            "Substitute", "Successive", "Successively", "Sufficient", "Suitably", "Summarize",
            "Superior", "Supervise", "Supplement", "Susceptible", "Suspend", "Sustainable",
            "Sustain", "Swift", "Symbolic", "Symbolize", "Sympathetic", "Synonymous",
            "Tackle", "Tactfully", "Tangible", "Tear apart", "Tentative", "Tentatively",
            "Terminate", "Terrifying", "Thorough", "Thoroughly", "Thoughtful", "Thoughtfully",
            "Thoughtless", "Thrive", "Thriving", "To a certain degree", "To a large extent",
            "To this end", "Tolerate", "Torture", "Toughen", "Trace", "Traditional",
            "Transform", "Transmit", "Tremendous", "Trigger", "Typical", "Typically",
            "Ultimate", "Ultimately", "Unanimous", "Unanimously", "Unavoidably", "Unclearly",
            "Unconcernedly", "Under no circumstances", "Under pressure", "Undergo", "Underline",
            "Undermine", "Undertake", "Unequally", "Unevenly", "Unfavourably", "Unify",
            "Unintentionally", "Uninterestedly", "Unite", "Universal", "Universally",
            "Unmask", "Unresponsive", "Unusually", "Unwillingly", "Uphold", "Urge", "Urgent",
            "Urgently", "Utilize", "Vacant", "Vague", "Valid", "Validate", "Valuable",
            "Vanish", "Varied", "Various", "Vary", "Vast", "Verify", "Versatile", "Vibrant",
            "Vigorous", "Vigorously", "Violently", "Visible", "Visualize", "Void",
            "Voluntary", "Voluntarily", "Vulnerable", "Wander", "Warrant", "Weighty", "Wicked",
            "Widespread", "Widely", "Willingly", "With reference to", "With regard to",
            "With the exception of", "With the help of", "With the intention of", "Worldly",
            "Worsen", "Worrisome", "Yearn for", "Yield", "Abbreviate", "Abound", "Acclaimed",
            "Acute", "Adamantly", "Adhere to", "Adherent", "Administer", "Adverse",
            "Adversely", "Affluent", "Affluently", "Aggravate", "Agitated", "Akin to",
            "Allege", "Alleviate", "Allocate", "Alluring", "Ambiguous", "Amplify", "Ample",
            "Annex", "Annihilate", "Antagonistic", "Antecedent", "Apprehensive", "Apt to",
            "Arable", "Arbitrary", "Arbitrarily", "Archaic", "Arduous", "Arid", "Ascertain",
            "Aspire", "Assert", "Assertive", "Assuredly", "At odds with", "At the expense of",
            "Augment", "Austere", "Autonomous", "Autonomously", "Avert", "Avid", "Barren",
            "Belligerent", "Benign", "Bewildering", "Boundless", "Boundlessly", "By and large",
            "Cast light on", "Catastrophic", "Cease", "Celestial", "Chiefly", "Cognitive",
            "Coincide", "Come to terms with", "Commence", "Communal", "Compactly",
            "Compassionate", "Compel", "Compelling", "Complement", "Comply with", "Comprehend",
            "Comprehensive", "Comprehensively", "Comprise", "Conceal", "Concede", "Conceive",
            "Concise", "Concisely", "Concur", "Confer", "Conjunction", "Conscience",
            "Conscientiously", "Consecutive", "Consecutively", "Consent", "Constitute",
            "Convict of", "Convicted", "Copious", "Correspondingly", "Counterfeit",
            "Courteous", "Courteously", "Crave", "Culprit", "Curb", "Curtail", "Customary",
            "Cynical", "Deduce", "Deduce from", "Deem", "Deter", "Deteriorate", "Detrimental",
            "Deviate", "Devise", "Disclose", "Discriminate", "Dwell", "Embark on", "Emit",
            "Empirical", "Enact", "Encompass", "Endemic", "Endorse", "Endure", "Engender",
            "Entail", "Envisage", "Equivocal", "Erect", "Evoke", "Exemplify", "Expend",
            "Exploit", "Extraterrestrial", "Fabricate", "Halt", "Hampering", "Haphazard",
            "Hard-headed", "Harmonious", "Harmoniously", "Harness", "Hasten", "Heartening",
            "Hereditary", "Hinder", "Hypothesize", "Ignite", "Illegitimate", "Illicit",
            "Illustrious", "Imminent", "Impartial", "Impartially", "Imperative",
            "Imperatively", "Implicit", "Imply", "Impose", "Impoverished", "Improbable",
            "Inborn", "Incalculable", "Incessantly", "Incoherent", "Incompatible",
            "Indefinitely", "Indigenous", "Indignant", "Indisputable", "Indispensable",
            "Inevitable", "Inevitably", "Infeasible", "Infamous", "Infer", "Ingenious",
            "Inherent", "Inhibit", "Inhospitable", "Initiate", "Innate", "Inquire",
            "Instigate", "Instinctive", "Insubordinately", "Intact", "Intangible",
            "Intensional", "Interim", "Intervene", "Intricate", "Intrinsic", "Intuitive",
            "Invalidate", "Jubilant", "Laborious", "Lavish", "Legitimate", "Lucrative",
            "Luminous", "Lush", "Malignant", "Malleable", "Maltreat", "Mandate", "Mandatory",
            "Manifest", "Meagre", "Meagrely", "Meditative", "Meticulous", "Miscellaneous",
            "Mitigate", "Monumental", "Monumentally", "Negligible", "Notional", "Notorious",
            "Nullify", "Oblique", "Oblige", "Obligatory", "Obscure", "Obsolete", "Obstinate",
            "Obstinately", "Obstruct", "Obstructive", "Opaque", "Oppress", "Ostentatious",
            "Outmoded", "Overwhelming", "Overwhelmingly", "Paramount", "Pensively",
            "Perilous", "Perplex", "Perpetual", "Perpetually", "Phenomenally", "Plummet",
            "Precede", "Preceding", "Predate", "Predominantly", "Premeditated", "Prerequisite",
            "Presume", "Pretentious", "Prevalent", "Primal", "Primarily", "Primeval",
            "Primitive", "Principal", "Principally", "Proclaim", "Procrastinate", "Profound",
            "Profoundly", "Prolific", "Prominent", "Prosecute", "Provoke", "Radically",
            "Ratify", "Recede", "Recurrent", "Regal", "Render", "Renounce", "Repeal",
            "Resent", "Resilient", "Resolute", "Resolutely", "Retard", "Ruthless", "Scanty",
            "Sceptically", "Scornful", "Scrupulous", "Scrutinize", "Subjective", "Subtle",
            "Supplant", "Suppress", "Surpass", "Unearth", "Unparalleled", "Unravel",
            "Unrivalled", "Utterly"
        ];

        // Mistral AI API Configuration
        const MISTRAL_API_KEY = 'UyFZtjZY3r5aNe1th2qtx6IBLynCc0ai';
        const MISTRAL_API_URL = 'https://api.mistral.ai/v1/chat/completions';

        // Spaced Repetition Algorithm
        class SpacedRepetition {
            constructor() {
                this.intervals = [1, 3, 7, 14, 30, 60, 120]; // Days between reviews
                this.loadData();
            }

            loadData() {
                const saved = localStorage.getItem('wordProgress');
                this.progress = saved ? JSON.parse(saved) : {};
            }

            saveData() {
                localStorage.setItem('wordProgress', JSON.stringify(this.progress));
            }

            getWordData(word) {
                if (!this.progress[word]) {
                    this.progress[word] = {
                        level: 0, // 0 = new, 1-7 = learning levels
                        nextReview: Date.now(),
                        correctCount: 0,
                        incorrectCount: 0,
                        lastReviewed: null
                    };
                }
                return this.progress[word];
            }

            processResult(word, known) {
                const data = this.getWordData(word);
                data.lastReviewed = Date.now();

                if (known) {
                    data.correctCount++;
                    if (data.level < this.intervals.length) {
                        data.level++;
                    }
                    // Calculate next review date
                    const daysToAdd = this.intervals[Math.min(data.level - 1, this.intervals.length - 1)];
                    data.nextReview = Date.now() + (daysToAdd * 24 * 60 * 60 * 1000);
                } else {
                    data.incorrectCount++;
                    // Reset to earlier level but not completely
                    data.level = Math.max(0, data.level - 1);
                    // Review again soon (in 10 minutes)
                    data.nextReview = Date.now() + (10 * 60 * 1000);
                }

                this.saveData();
                return data;
            }

            getDueWords() {
                const now = Date.now();
                return MYWORDS.filter(word => {
                    const data = this.getWordData(word);
                    return data.nextReview <= now;
                });
            }

            getStats() {
                let learned = 0;
                let toReview = 0;
                const now = Date.now();

                MYWORDS.forEach(word => {
                    const data = this.getWordData(word);
                    if (data.level >= 4) {
                        learned++;
                    }
                    if (data.nextReview <= now) {
                        toReview++;
                    }
                });

                return { learned, toReview };
            }
        }

        // Cache for word definitions
        const wordCache = {};
        const prefetchQueue = new Set();

        // Fetch word data from Mistral AI
        async function fetchWordData(word) {
            if (wordCache[word]) {
                return wordCache[word];
            }

            // Mark as being fetched to prevent duplicate requests
            if (prefetchQueue.has(word)) {
                // Wait for the existing request to complete
                while (!wordCache[word]) {
                    await new Promise(r => setTimeout(r, 50));
                }
                return wordCache[word];
            }

            prefetchQueue.add(word);

            try {
                const response = await fetch(MISTRAL_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${MISTRAL_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'mistral-large-latest',
                        messages: [
                            {
                                role: 'system',
                                content: 'You are a helpful English vocabulary tutor. Provide clear, concise definitions and natural example sentences. Respond ONLY in JSON format.'
                            },
                            {
                                role: 'user',
                                content: `Provide a BRIEF academic definition (1 concise sentence, max 20 words) and a short academic example sentence (max 25 words) that USES "${word}". Be concise. Format as JSON: {"definition": "...", "example": "..."}`
                            }
                        ],
                        temperature: 0.3,
                        max_tokens: 200
                    })
                });

                if (!response.ok) {
                    throw new Error('API request failed');
                }

                const data = await response.json();
                const content = data.choices[0].message.content;
                
                // Extract JSON from response
                let jsonMatch = content.match(/\{[^}]+\}/);
                if (jsonMatch) {
                    const result = JSON.parse(jsonMatch[0]);
                    wordCache[word] = result;
                    return result;
                }
            } catch (error) {
                console.error('Error fetching word data:', error);
            } finally {
                prefetchQueue.delete(word);
            }

            // Fallback data
            const fallback = {
                definition: `A word or phrase expressing ${word.toLowerCase()}.`,
                example: `The teacher asked us to use "${word}" in a sentence.`
            };
            wordCache[word] = fallback;
            return fallback;
        }

        // Prefetch next N cards in the background
        function prefetchUpcomingCards() {
            const prefetchCount = 3; // Prefetch next 3 cards
            for (let i = 1; i <= prefetchCount; i++) {
                const nextIndex = currentIndex + i;
                if (nextIndex < currentCards.length) {
                    const nextWord = currentCards[nextIndex];
                    if (!wordCache[nextWord] && !prefetchQueue.has(nextWord)) {
                        // Fetch in background without awaiting
                        fetchWordData(nextWord).catch(() => {});
                    }
                }
            }
        }

        // App State
        const sr = new SpacedRepetition();
        let currentCards = [];
        let currentIndex = 0;
        let streak = 0;
        let isProcessing = false;

        // Initialize
        async function init() {
            updateStats();
            await loadCards();
        }

        function updateStats() {
            const stats = sr.getStats();
            document.getElementById('toReviewCount').textContent = stats.toReview;
            document.getElementById('learnedCount').textContent = stats.learned;
            document.getElementById('streakCount').textContent = streak;
            
            const progress = ((MYWORDS.length - stats.toReview) / MYWORDS.length) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        async function loadCards() {
            const dueWords = sr.getDueWords();
            
            if (dueWords.length === 0) {
                showEmptyState();
                return;
            }

            // Shuffle and take up to 20 cards per session
            const sessionWords = dueWords
                .sort(() => Math.random() - 0.5)
                .slice(0, 20);

            currentCards = sessionWords;
            currentIndex = 0;

            // Pre-fetch first few cards
            for (let i = 0; i < Math.min(3, sessionWords.length); i++) {
                fetchWordData(sessionWords[i]);
            }

            await renderCard();
            
            // Start prefetching upcoming cards immediately
            prefetchUpcomingCards();
        }

        async function renderCard() {
            const container = document.getElementById('cardContainer');
            
            if (currentIndex >= currentCards.length) {
                showSessionComplete();
                return;
            }

            const word = currentCards[currentIndex];
            const wordData = sr.getWordData(word);
            
            container.innerHTML = `
                <div class="card" id="currentCard">
                    <div class="level-indicator">Lvl ${wordData.level}</div>
                    <div class="card-badge dont-know" id="badgeDontKnow">NO</div>
                    <div class="card-badge know" id="badgeKnow">YES</div>
                    <div class="word">${word}</div>
                    <div class="divider"></div>
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Loading...</p>
                    </div>
                </div>
            `;

            // Enable swipe on the card
            enableSwipe();

            // Fetch and display word data
            const data = await fetchWordData(word);
            
            // Highlight the word in the example
            const highlightedExample = highlightWordInExample(data.example, word);
            
            const card = document.getElementById('currentCard');
            if (card) {
                card.innerHTML = `
                    <div class="level-indicator">Lvl ${wordData.level}</div>
                    <div class="card-badge dont-know" id="badgeDontKnow">NO</div>
                    <div class="card-badge know" id="badgeKnow">YES</div>
                    <div class="word">${word}</div>
                    <div class="divider"></div>
                    <div class="content-scroll">
                        <div>
                            <div class="section-title">Example</div>
                            <div class="example">"${highlightedExample}"</div>
                        </div>
                        <div>
                            <div class="section-title">Definition</div>
                            <div class="definition">${data.definition}</div>
                        </div>
                    </div>

                `;
            }

            // Pre-fetch upcoming cards
            prefetchUpcomingCards();
        }

        function enableSwipe() {
            const card = document.getElementById('currentCard');
            if (!card) return;

            let startX = 0;
            let currentX = 0;
            let isDragging = false;

            const startDrag = (e) => {
                if (isProcessing) return;
                isDragging = true;
                startX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                card.style.transition = 'none';
            };

            const drag = (e) => {
                if (!isDragging || isProcessing) return;
                
                const touch = e.type.includes('mouse') ? e : e.touches[0];
                currentX = touch.clientX;
                const deltaX = currentX - startX;
                const rotation = deltaX * 0.05;
                
                card.style.transform = `translateX(${deltaX}px) rotate(${rotation}deg)`;

                // Show badge in center based on swipe direction with opacity based on distance
                const badgeKnow = document.getElementById('badgeKnow');
                const badgeDontKnow = document.getElementById('badgeDontKnow');
                
                if (deltaX > 30) {
                    const intensity = Math.min((deltaX - 30) / 70, 1);
                    badgeKnow.style.opacity = intensity;
                    badgeKnow.style.transform = `translate(-50%, -50%) scale(${0.8 + intensity * 0.2}) rotate(${8 * intensity}deg)`;
                    badgeDontKnow.style.opacity = 0;
                } else if (deltaX < -30) {
                    const intensity = Math.min((Math.abs(deltaX) - 30) / 70, 1);
                    badgeDontKnow.style.opacity = intensity;
                    badgeDontKnow.style.transform = `translate(-50%, -50%) scale(${0.8 + intensity * 0.2}) rotate(${-8 * intensity}deg)`;
                    badgeKnow.style.opacity = 0;
                } else {
                    badgeKnow.style.opacity = 0;
                    badgeDontKnow.style.opacity = 0;
                }
            };

            const endDrag = () => {
                if (!isDragging || isProcessing) return;
                isDragging = false;
                
                const deltaX = currentX - startX;
                card.style.transition = 'transform 0.25s ease';

                if (deltaX > 80) {
                    card.classList.add('swiping-right');
                    setTimeout(() => handleKnow(), 250);
                } else if (deltaX < -80) {
                    card.classList.add('swiping-left');
                    setTimeout(() => handleDontKnow(), 250);
                } else {
                    card.style.transform = '';
                    const badgeKnow = document.getElementById('badgeKnow');
                    const badgeDontKnow = document.getElementById('badgeDontKnow');
                    if (badgeKnow) {
                        badgeKnow.classList.remove('show');
                        badgeKnow.style.opacity = '';
                        badgeKnow.style.transform = '';
                    }
                    if (badgeDontKnow) {
                        badgeDontKnow.classList.remove('show');
                        badgeDontKnow.style.opacity = '';
                        badgeDontKnow.style.transform = '';
                    }
                }
            };

            // Touch events - optimized for iPhone
            card.addEventListener('touchstart', startDrag, { passive: true });
            card.addEventListener('touchmove', drag, { passive: true });
            card.addEventListener('touchend', endDrag);
            card.addEventListener('touchcancel', endDrag);

            // Mouse events
            card.addEventListener('mousedown', startDrag);
            card.addEventListener('mousemove', drag);
            card.addEventListener('mouseup', endDrag);
            card.addEventListener('mouseleave', () => {
                if (isDragging) endDrag();
            });
        }

        function handleKnow() {
            if (isProcessing) return;
            isProcessing = true;

            const word = currentCards[currentIndex];
            sr.processResult(word, true);
            streak++;
            
            const card = document.getElementById('currentCard');
            if (card) {
                card.classList.add('swiping-right');
            }

            setTimeout(() => {
                currentIndex++;
                updateStats();
                renderCard();
                isProcessing = false;
            }, 300);
        }

        function handleDontKnow() {
            if (isProcessing) return;
            isProcessing = true;

            const word = currentCards[currentIndex];
            sr.processResult(word, false);
            streak = 0;
            
            const card = document.getElementById('currentCard');
            if (card) {
                card.classList.add('swiping-left');
            }

            setTimeout(() => {
                currentIndex++;
                updateStats();
                renderCard();
                isProcessing = false;
            }, 300);
        }

        function showEmptyState() {
            const container = document.getElementById('cardContainer');
            container.innerHTML = `
                <div class="empty-state">
                    <h2>üéâ All Caught Up!</h2>
                    <p>You have no words due for review right now.</p>
                    <p>Come back later for more practice!</p>
                    <button class="btn-primary" onclick="resetProgress()">Start Fresh</button>
                </div>
            `;
            document.getElementById('controls').style.display = 'none';
        }

        function showSessionComplete() {
            const container = document.getElementById('cardContainer');
            const stats = sr.getStats();
            container.innerHTML = `
                <div class="empty-state">
                    <h2>üéØ Session Complete!</h2>
                    <p>You reviewed ${currentCards.length} words.</p>
                    <p>Words learned: ${stats.learned} / ${MYWORDS.length}</p>
                    <button class="btn-primary" onclick="loadCards()">Continue Learning</button>
                </div>
            `;
            document.getElementById('controls').style.display = 'none';
        }

        function resetProgress() {
            if (confirm('Reset all progress? This cannot be undone.')) {
                localStorage.removeItem('wordProgress');
                location.reload();
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') {
                handleKnow();
            } else if (e.key === 'ArrowLeft') {
                handleDontKnow();
            }
        });

        // Highlight word in example sentence (case-insensitive, preserves original casing)
        function highlightWordInExample(example, word) {
            if (!example || !word) return example;
            
            // Escape special regex characters in the word
            const escapedWord = word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            
            // Create regex that matches the word with word boundaries, case-insensitive
            const regex = new RegExp(`\\b(${escapedWord})\\b`, 'gi');
            
            // Replace with highlighted version (preserving original case)
            return example.replace(regex, '<span class="highlight-word">$1</span>');
        }

        // iOS-specific optimizations
        document.addEventListener('gesturestart', (e) => e.preventDefault());
        document.addEventListener('gesturechange', (e) => e.preventDefault());
        document.addEventListener('gestureend', (e) => e.preventDefault());
        
        // Prevent double-tap zoom
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (e) => {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, { passive: false });

        // Modal functions
        function showInfoModal() {
            const modal = document.getElementById('infoModal');
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeInfoModal(event) {
            if (event && event.target !== event.currentTarget && event.type !== 'click') {
                return;
            }
            const modal = document.getElementById('infoModal');
            modal.classList.remove('show');
            document.body.style.overflow = '';
        }

        // Word List Modal Functions
        let currentFilter = 'all';
        let wordListData = [];

        function showWordListModal() {
            const modal = document.getElementById('wordListModal');
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
            
            // Prepare word data
            prepareWordListData();
            
            // Update summary
            updateWordListSummary();
            
            // Render list
            renderWordList();
        }

        function closeWordListModal(event) {
            if (event && event.target !== event.currentTarget && event.type !== 'click') {
                return;
            }
            const modal = document.getElementById('wordListModal');
            modal.classList.remove('show');
            document.body.style.overflow = '';
        }

        function prepareWordListData() {
            wordListData = MYWORDS.map(word => {
                const data = sr.getWordData(word);
                return {
                    word: word,
                    level: data.level,
                    nextReview: data.nextReview,
                    correctCount: data.correctCount,
                    incorrectCount: data.incorrectCount,
                    status: data.level >= 4 ? 'learned' : (data.level > 0 ? 'learning' : 'new')
                };
            });
        }

        function updateWordListSummary() {
            const total = wordListData.length;
            const learned = wordListData.filter(w => w.status === 'learned').length;
            const learning = wordListData.filter(w => w.status === 'learning').length;
            const progress = total > 0 ? Math.round((learned / total) * 100) : 0;
            
            document.getElementById('totalWordsCount').textContent = total;
            document.getElementById('learnedWordsCount').textContent = learned;
            document.getElementById('learningWordsCount').textContent = learning;
            document.getElementById('progressPercent').textContent = progress + '%';
        }

        function filterWords(filter) {
            currentFilter = filter;
            
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.filter === filter);
            });
            
            renderWordList();
        }

        function searchWords() {
            renderWordList();
        }

        function renderWordList() {
            const container = document.getElementById('wordListContainer');
            const searchTerm = document.getElementById('wordSearch').value.toLowerCase();
            
            let filtered = wordListData;
            
            // Apply status filter
            if (currentFilter !== 'all') {
                filtered = filtered.filter(w => w.status === currentFilter);
            }
            
            // Apply search filter
            if (searchTerm) {
                filtered = filtered.filter(w => w.word.toLowerCase().includes(searchTerm));
            }
            
            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-list">
                        <div class="empty-list-icon">üîç</div>
                        <div class="empty-list-text">No words found</div>
                    </div>
                `;
                return;
            }
            
            // Group by status
            const groups = {};
            filtered.forEach(w => {
                const groupKey = w.status === 'learned' ? '‚úì Learned' : 
                                w.status === 'learning' ? 'üìö Learning' : 'üÜï New';
                if (!groups[groupKey]) groups[groupKey] = [];
                groups[groupKey].push(w);
            });
            
            // Sort groups: Learned first, then Learning, then New
            const groupOrder = ['‚úì Learned', 'üìö Learning', 'üÜï New'];
            
            let html = '';
            groupOrder.forEach(groupName => {
                if (groups[groupName]) {
                    const words = groups[groupName].sort((a, b) => a.word.localeCompare(b.word));
                    
                    html += `
                        <div class="word-group">
                            <div class="word-group-title">${groupName} (${words.length})</div>
                    `;
                    
                    words.forEach(w => {
                        const progressPercent = Math.min((w.level / 7) * 100, 100);
                        const nextReviewText = getNextReviewText(w.nextReview);
                        
                        html += `
                            <div class="word-item">
                                <div class="word-info">
                                    <div class="word-name">${w.word}</div>
                                    <div class="word-status">
                                        <span class="level-badge ${w.status}">Lvl ${w.level}</span>
                                        <span class="next-review">${nextReviewText}</span>
                                    </div>
                                </div>
                                <div class="word-progress">
                                    <div class="word-progress-bar ${w.status}" style="width: ${progressPercent}%"></div>
                                </div>
                            </div>
                        `;
                    });
                    
                    html += '</div>';
                }
            });
            
            container.innerHTML = html;
        }

        function getNextReviewText(nextReview) {
            const now = Date.now();
            const diff = nextReview - now;
            
            if (diff <= 0) return 'Due now';
            
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const days = Math.floor(hours / 24);
            
            if (days > 0) return `in ${days}d`;
            if (hours > 0) return `in ${hours}h`;
            return 'Soon';
        }

        // Close modal on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeInfoModal();
                closeWordListModal();
            }
        });

        // Start the app
        init();
    </script>
</body>
</html>
